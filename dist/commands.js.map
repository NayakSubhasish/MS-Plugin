{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://outlook-plugin/webpack/runtime/load script","webpack://outlook-plugin/./node_modules/es6-promise/dist/es6-promise.js","webpack://outlook-plugin/webpack/bootstrap","webpack://outlook-plugin/webpack/runtime/define property getters","webpack://outlook-plugin/webpack/runtime/ensure chunk","webpack://outlook-plugin/webpack/runtime/get javascript chunk filename","webpack://outlook-plugin/webpack/runtime/global","webpack://outlook-plugin/webpack/runtime/hasOwnProperty shorthand","webpack://outlook-plugin/webpack/runtime/make namespace object","webpack://outlook-plugin/webpack/runtime/publicPath","webpack://outlook-plugin/webpack/runtime/jsonp chunk loading","webpack://outlook-plugin/./src/commands/commands.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"outlook-plugin:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    var then$$1 = void 0;\n    try {\n      then$$1 = value.then;\n    } catch (error) {\n      reject(promise, error);\n      return;\n    }\n    handleMaybeThenable(promise, value, then$$1);\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = true;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n    } catch (e) {\n      succeeded = false;\n      error = e;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (succeeded === false) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = void 0;\n      var error = void 0;\n      var didError = false;\n      try {\n        _then = entry.then;\n      } catch (e) {\n        didError = true;\n        error = e;\n      }\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        if (didError) {\n          reject(promise, error);\n        } else {\n          handleMaybeThenable(promise, entry, _then);\n        }\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n//# sourceMappingURL=es6-promise.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t217: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkoutlook_plugin\"] = self[\"webpackChunkoutlook_plugin\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global Office */\n\n// Log that commands.js is being loaded\nconsole.log('🚀 COMMANDS.JS LOADED - Email validation system initializing...');\nconsole.log('📅 Load time:', new Date().toISOString());\n\n// Import the BotAtWork API for generating enhanced emails\nconst BOTATWORK_API_KEY = \"e80f5458c550f5b85ef56175b789468a\";\nconst BOTATWORK_API_URL = \"https://api.botatwork.com/trigger-task/b6f44edd-8140-4084-881e-2c11c403c082\";\n\n// Import getSuggestedReply function for consistent API calls\nlet getSuggestedReply;\n\n// Try to import getSuggestedReply from the taskpane\ntry {\n  if (typeof window !== 'undefined' && window.getSuggestedReply) {\n    getSuggestedReply = window.getSuggestedReply;\n    console.log('✅ getSuggestedReply imported from window');\n  } else {\n    console.log('⚠️ getSuggestedReply not found on window, will define locally');\n  }\n} catch (error) {\n  console.error('❌ Error importing getSuggestedReply:', error);\n}\n\n// Local implementation of getSuggestedReply if import fails\nif (!getSuggestedReply) {\n  getSuggestedReply = async function(params) {\n    console.log('🔧 Using local getSuggestedReply implementation');\n    console.log('📤 API params:', params);\n    \n    try {\n      const response = await fetch(BOTATWORK_API_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${BOTATWORK_API_KEY}`\n        },\n        body: JSON.stringify(params)\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      const data = await response.json();\n      console.log('📥 API response:', data);\n      \n      return data.result || data.response || data.content || 'Enhanced email content generated';\n    } catch (error) {\n      console.error('❌ Local API call failed:', error);\n      throw error;\n    }\n  };\n  console.log('✅ Local getSuggestedReply implementation ready');\n}\ntry {\n  // Try to import the function (this will work in module environments)\n  import('../taskpane/botAtWorkApi.js').then(module => {\n    getSuggestedReply = module.getSuggestedReply;\n  });\n} catch (e) {\n  console.log('Could not import getSuggestedReply, will use direct API calls');\n}\n\n// Define required keywords and their categories\n// TODO: Make this configurable via API for different industries/companies\nconst REQUIRED_KEYWORDS = {\n  agenda: {\n    keywords: ['agenda', 'meeting agenda', 'topics to discuss', 'discussion points'],\n    category: 'Meeting Structure',\n    suggestions: ['agenda', 'meeting topics', 'discussion items']\n  },\n  action: {\n    keywords: ['action item', 'action required', 'next steps', 'follow up', 'todo'],\n    category: 'Action Items',\n    suggestions: ['action items', 'next steps', 'follow-up required']\n  },\n  timeline: {\n    keywords: ['deadline', 'due date', 'timeline', 'schedule', 'by when'],\n    category: 'Timeline',\n    suggestions: ['deadline', 'timeline', 'completion date']\n  },\n  participants: {\n    keywords: ['attendees', 'participants', 'who should attend', 'invitees'],\n    category: 'Participants',\n    suggestions: ['attendees', 'participants', 'invitees']\n  },\n  greeting: {\n    keywords: ['dear', 'hello', 'hi', 'good morning', 'good afternoon'],\n    category: 'Greeting',\n    suggestions: ['Dear', 'Hello', 'Hi']\n  },\n  closing: {\n    keywords: ['regards', 'best regards', 'sincerely', 'thank you', 'thanks'],\n    category: 'Closing',\n    suggestions: ['Best regards', 'Thank you', 'Sincerely']\n  }\n};\n\n// Track validation state to ensure it triggers every time\nlet validationState = {\n  lastValidationTime: 0,\n  lastEmailBody: '',\n  validationInProgress: false\n};\n\n// Helper function to convert markdown to proper HTML for Outlook\nfunction convertMarkdownToOutlookHtml(markdownText) {\n  if (!markdownText || typeof markdownText !== 'string') {\n    return markdownText || '';\n  }\n\n  // First, handle tables before other conversions\n  let html = markdownText;\n  \n  // Convert markdown tables to HTML tables\n  html = html.replace(/^([^\\n]*\\|[^\\n]*\\n)([^\\n]*\\|[^\\n]*\\n)([^\\n]*\\|[^\\n]*\\n)+/gm, (match) => {\n    const lines = match.trim().split('\\n');\n    if (lines.length < 3) return match; // Need at least header, separator, and one data row\n    \n    const header = lines[0];\n    const separator = lines[1];\n    const dataRows = lines.slice(2);\n    \n    // Check if separator line contains dashes and pipes (table format)\n    if (!/^\\s*\\|?\\s*:?[-|:\\s]+\\s*\\|?\\s*$/.test(separator)) {\n      return match; // Not a valid table separator\n    }\n    \n    // Parse header\n    const headerCells = header.split('|').map(cell => cell.trim()).filter(Boolean);\n    \n    // Parse data rows\n    const tableRows = dataRows.map(row => {\n      const cells = row.split('|').map(cell => cell.trim()).filter(Boolean);\n      return cells;\n    });\n    \n    // Build HTML table\n    let tableHtml = '<table style=\"border-collapse: collapse; width: 100%; margin: 16px 0; border: 1px solid #d1d1d1;\">';\n    \n    // Add header\n    if (headerCells.length > 0) {\n      tableHtml += '<thead><tr>';\n      headerCells.forEach(cell => {\n        tableHtml += `<th style=\"border: 1px solid #d1d1d1; padding: 8px 12px; background-color: #f8f9fa; font-weight: 600; text-align: left;\">${escapeHtml(cell)}</th>`;\n      });\n      tableHtml += '</tr></thead>';\n    }\n    \n    // Add data rows\n    if (tableRows.length > 0) {\n      tableHtml += '<tbody>';\n      tableRows.forEach(row => {\n        tableHtml += '<tr>';\n        row.forEach(cell => {\n          tableHtml += `<td style=\"border: 1px solid #d1d1d1; padding: 8px 12px; vertical-align: top;\">${escapeHtml(cell)}</td>`;\n        });\n        // Fill any missing cells if row is shorter than header\n        for (let i = row.length; i < headerCells.length; i++) {\n          tableHtml += '<td style=\"border: 1px solid #d1d1d1; padding: 8px 12px; vertical-align: top;\"></td>';\n        }\n        tableHtml += '</tr>';\n      });\n      tableHtml += '</tbody>';\n    }\n    \n    tableHtml += '</table>';\n    return tableHtml;\n  });\n\n  // Now handle other markdown elements\n  html = html\n    // Convert bullet points (both - and * formats)\n    .replace(/^[\\s]*[-*][\\s]+(.+)$/gm, '<li>$1</li>')\n    // Convert numbered lists\n    .replace(/^[\\s]*\\d+\\.\\s+(.+)$/gm, '<li>$1</li>')\n    // Wrap lists in proper ul/ol tags\n    .replace(/(<li>.*<\\/li>)/gs, '<ul>$1</ul>')\n    // Convert bold text (**text** or __text__)\n    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    .replace(/__(.*?)__/g, '<strong>$1</strong>')\n    // Convert italic text (*text* or _text_)\n    .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n    .replace(/_(.*?)__/g, '<em>$1</em>')\n    // Convert line breaks to proper HTML\n    .replace(/\\n\\n+/g, '</p><p>')\n    .replace(/\\n/g, '<br/>')\n    // Wrap in paragraph tags\n    .replace(/^(.+)$/s, '<p>$1</p>')\n    // Clean up empty paragraphs and double tags\n    .replace(/<p><\\/p>/g, '')\n    .replace(/<p><p>/g, '<p>')\n    .replace(/<\\/p><\\/p>/g, '</p>')\n    // Fix list formatting - ensure proper spacing\n    .replace(/<\\/ul>\\s*<ul>/g, '</ul><ul>')\n    .replace(/<\\/p>\\s*<ul>/g, '</p><ul>')\n    .replace(/<\\/ul>\\s*<p>/g, '</ul><p>');\n\n  return html;\n}\n\n// Helper function to escape HTML special characters\nfunction escapeHtml(text) {\n  if (!text) return '';\n  return String(text)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\n// Main validation function called on email send\nfunction validateEmail(event) {\n  console.log('🚀🚀🚀 EMAIL VALIDATION TRIGGERED - SEND BUTTON INTERCEPTED! 🚀🚀🚀');\n  console.log('🔥 SUCCESS: Send interception is working! 🔥');\n  console.log('Event object:', event);\n  console.log('📅 Timestamp:', new Date().toISOString());\n  console.log('🔧 validateEmail function loaded and called');\n  \n  // Show alert to confirm interception is working\n  console.log('🎯 SHOWING VALIDATION DIALOG...');\n  console.log('🎯 Event type:', typeof event);\n  console.log('🎯 Event completed function:', typeof event?.completed);\n  \n  // CRITICAL: Show alert to confirm validation is being called\n  console.log('🚨 SHOWING ALERT TO CONFIRM VALIDATION IS CALLED');\n  \n  // CRITICAL: Store the event globally for debugging\n  window.lastValidationEvent = event;\n  \n  // Reset validation state for new validation\n  validationState.validationInProgress = false;\n  \n  // Add debugging information\n  if (!event) {\n    console.error('❌ No event object provided to validateEmail');\n    return;\n  }\n  \n  if (!Office.context || !Office.context.mailbox || !Office.context.mailbox.item) {\n    console.error('❌ Office context not available');\n    if (event && typeof event.completed === 'function') {\n      event.completed({ allowEvent: true });\n    }\n    return;\n  }\n  \n  const item = Office.context.mailbox.item;\n  \n  // Get email body content\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body:', result.error);\n      event.completed({ allowEvent: true });\n      return;\n    }\n    \n    const bodyText = result.value.toLowerCase();\n    console.log('📧 Email body length:', bodyText.length);\n    console.log('📧 Email body preview:', bodyText.substring(0, 200) + '...');\n    \n    // Update validation state\n    validationState.lastEmailBody = bodyText;\n    validationState.lastValidationTime = Date.now();\n    \n    const missing = [];\n    \n    // Check for missing keywords\n    Object.keys(REQUIRED_KEYWORDS).forEach(key => {\n      const keywordData = REQUIRED_KEYWORDS[key];\n      const hasKeyword = keywordData.keywords.some(keyword => \n        bodyText.includes(keyword.toLowerCase())\n      );\n      \n      if (!hasKeyword) {\n        missing.push({\n          category: keywordData.category,\n          suggestions: keywordData.suggestions,\n          key: key\n        });\n      }\n    });\n    \n    console.log('🔍 Missing keywords found:', missing.length);\n    if (missing.length > 0) {\n      console.log('❌ Missing categories:', missing.map(m => m.category));\n      console.log('🎯 SHOWING VALIDATION DIALOG FOR INCOMPLETE EMAIL');\n      // Show validation dialog\n      validationState.validationInProgress = true;\n      showValidationDialog(missing, event);\n    } else {\n      console.log('✅ All keywords present, allowing send');\n      // All keywords present, allow send\n      if (event && typeof event.completed === 'function') {\n        event.completed({ allowEvent: true });\n      }\n    }\n    \n    // Add a timeout fallback to ensure event is always completed\n    setTimeout(() => {\n      console.log('⏰ Validation timeout fallback - ensuring event completion');\n      if (event && typeof event.completed === 'function' && !validationState.validationInProgress) {\n        event.completed({ allowEvent: true });\n      }\n    }, 30000); // 30 second timeout\n  });\n}\n\n// Show validation dialog with missing keywords\nfunction showValidationDialog(missing, event) {\n  const dialogUrl = getDialogUrl();\n  console.log('🔍 Opening validation dialog:', dialogUrl);\n  console.log('📊 Missing keywords data:', missing);\n  console.log('🎯 Event object available:', !!event);\n  \n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { \n      height: 40, \n      width: 35,\n      displayInIframe: true\n    },\n    (asyncResult) => {\n      if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n        console.error('❌ Failed to open dialog:', asyncResult.error);\n        event.completed({ allowEvent: true });\n        return;\n      }\n      \n      console.log('✅ Dialog opened successfully');\n      const dialog = asyncResult.value;\n      \n      // Send missing keywords data to dialog with multiple attempts\n      let attempts = 0;\n      const maxAttempts = 5;\n      \n      const sendDataToDialog = () => {\n        attempts++;\n        console.log(`📤 Sending data to dialog (attempt ${attempts}):`, missing);\n        try {\n          dialog.messageChild(JSON.stringify({\n            type: 'missing-keywords',\n            data: missing\n          }));\n        } catch (error) {\n          console.error('❌ Error sending message to dialog:', error);\n          if (attempts < maxAttempts) {\n            setTimeout(sendDataToDialog, 1000);\n          }\n        }\n      };\n      \n      // Send initial message after dialog loads\n      setTimeout(sendDataToDialog, 500);\n      \n      // Send backup messages\n      setTimeout(sendDataToDialog, 1500);\n      setTimeout(sendDataToDialog, 3000);\n      \n      // Handle dialog responses\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n        console.log('📥 Dialog response received:', arg.message);\n        const response = JSON.parse(arg.message);\n        \n        // Reset validation state\n        validationState.validationInProgress = false;\n        \n        if (response.action === 'send') {\n          console.log('✅ User chose to send anyway - ALLOWING SEND');\n          if (event && typeof event.completed === 'function') {\n            try {\n              event.completed({ allowEvent: true });\n              console.log('✅ event.completed({ allowEvent: true }) called successfully');\n            } catch (error) {\n              console.error('❌ Error calling event.completed for send:', error);\n            }\n          }\n        } else if (response.action === 'add-keywords') {\n          console.log('🔧 User wants to add keywords:', response.keywords);\n          addKeywordsToEmail(response.keywords, event);\n        } else if (response.action === 'cancel') {\n          console.log('❌ User cancelled - BLOCKING SEND');\n          console.log('🚫 Event completion with allowEvent: false');\n          console.log('🎯 About to call event.completed({ allowEvent: false })');\n          \n          if (event && typeof event.completed === 'function') {\n            try {\n              event.completed({ allowEvent: false });\n              console.log('✅ event.completed({ allowEvent: false }) called successfully');\n            } catch (error) {\n              console.error('❌ Error calling event.completed:', error);\n            }\n          }\n        } else {\n          console.log('❓ Unknown action:', response.action, '- BLOCKING SEND');\n          console.log('🚫 Event completion with allowEvent: false for unknown action');\n          \n          if (event && typeof event.completed === 'function') {\n            try {\n              event.completed({ allowEvent: false });\n              console.log('✅ event.completed({ allowEvent: false }) called successfully for unknown action');\n            } catch (error) {\n              console.error('❌ Error calling event.completed for unknown action:', error);\n            }\n          }\n        }\n        \n        console.log('🔒 Closing dialog');\n        dialog.close();\n      });\n      \n      // Handle dialog errors\n      dialog.addEventHandler(Office.EventType.DialogEventReceived, (arg) => {\n        console.error('❌ Dialog error:', arg.error);\n        // Reset validation state\n        validationState.validationInProgress = false;\n        event.completed({ allowEvent: true });\n      });\n    }\n  );\n}\n\n// Add selected keywords to email and regenerate content\nfunction addKeywordsToEmail(selectedKeywords, event) {\n  console.log('🔧 ADD KEYWORDS TO EMAIL TRIGGERED');\n  console.log('📝 Selected keywords:', selectedKeywords);\n  console.log('🎯 Event object available:', !!event);\n  \n  const item = Office.context.mailbox.item;\n  \n  // Get current email body\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body for keyword addition:', result.error);\n      if (event && typeof event.completed === 'function') {\n        event.completed({ allowEvent: false });\n      }\n      return;\n    }\n    \n    const currentBody = result.value;\n    console.log('📧 Current email body:', currentBody.substring(0, 200) + '...');\n    \n    // Determine if this is a new email or reply\n    const isReply = item.conversationId && item.conversationId.length > 0;\n    console.log('📨 Is reply:', isReply);\n    \n    // Create enhanced prompt with all missing keywords\n    const keywordsList = selectedKeywords.join(', ');\n    \n    // Get email subject using async method\n    console.log('📧 Item object available:', !!item);\n    console.log('📧 Getting subject asynchronously...');\n    \n    // Get subject asynchronously\n    item.subject.getAsync((subjectResult) => {\n      let emailSubject = '';\n      \n      if (subjectResult.status === Office.AsyncResultStatus.Succeeded) {\n        emailSubject = subjectResult.value || '';\n        console.log('📧 Subject retrieved successfully:', emailSubject);\n      } else {\n        console.log('📧 Failed to get subject:', subjectResult.error);\n        emailSubject = '';\n      }\n      \n      // Now create the enhancement prompt with the retrieved subject\n      const enhancementPrompt = `Please enhance this email by adding the missing keywords while maintaining the original context and intent.\n\nSubject: ${emailSubject}\n\nOriginal Email:\n${currentBody}\n\nMissing Keywords to Include: ${keywordsList}\n\nPlease rewrite this email to include all the missing keywords naturally while preserving the original purpose and context from the subject and content.`;\n\n      console.log('🤖 Enhancement prompt created');\n      console.log('📧 Subject being passed:', emailSubject);\n      console.log('📝 Body being passed:', currentBody.substring(0, 100) + '...');\n      console.log('🏷️ Keywords being passed:', keywordsList);\n      \n      // Prepare API parameters - let BotAPI handle the enhancement\n      const validationApiParams = {\n        chooseATask: \"emailResponse\",\n        emailContent: enhancementPrompt,\n        tone: \"professional\",\n        pointOfView: \"organizationPerspective\", \n        additionalInstructions: `Include these keywords: ${keywordsList}`,\n        anonymize: null,\n        incognito: false,\n        default_language: \"en-US\",\n        should_stream: false\n      };\n\n      // Call BotAtWork API directly for better reliability\n      console.log('🚀 Calling BotAtWork API for email enhancement...');\n      console.log('📧 Email subject:', emailSubject);\n      console.log('📝 Original content:', currentBody);\n      \n      if (typeof getSuggestedReply === 'function') {\n        console.log('✅ getSuggestedReply function available');\n        getSuggestedReply(validationApiParams)\n        .then(enhancedContent => {\n          console.log('🎉 Enhanced content received (full):', enhancedContent);\n          console.log('🔍 Content type:', typeof enhancedContent);\n          console.log('🔍 Content length:', enhancedContent ? enhancedContent.length : 'null');\n          console.log('🔍 Starts with API error?', enhancedContent ? enhancedContent.startsWith('API error:') : 'null');\n          console.log('🔍 Starts with Error calling?', enhancedContent ? enhancedContent.startsWith('Error calling BotAtWork API:') : 'null');\n          \n          if (enhancedContent && !enhancedContent.startsWith('API error:') && !enhancedContent.startsWith('Error calling BotAtWork API:')) {\n            // Update email body with enhanced content\n            console.log('📝 ATTEMPTING TO UPDATE EMAIL BODY...');\n            console.log('📧 Item object available:', !!item);\n            console.log('📧 Item.body available:', !!item.body);\n            console.log('📧 Item.body.setAsync available:', !!(item.body && item.body.setAsync));\n            console.log('📧 Enhanced content:', enhancedContent);\n\n            // Update email body with enhanced content - convert markdown to HTML for proper formatting\n            const formattedHtml = convertMarkdownToOutlookHtml(enhancedContent);\n            console.log('🔧 Converting markdown to HTML for Outlook...');\n            console.log('📝 Original content:', enhancedContent.substring(0, 200) + '...');\n            console.log('🔧 Formatted HTML:', formattedHtml.substring(0, 200) + '...');\n            \n            item.body.setAsync(\n              formattedHtml,\n              { coercionType: Office.CoercionType.Html },\n              (setResult) => {\n                console.log('📝 setAsync callback called');\n                console.log('📝 setResult status:', setResult.status);\n                console.log('📝 Expected success status:', Office.AsyncResultStatus.Succeeded);\n                \n                if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n                  console.log('✅ EMAIL BODY UPDATED SUCCESSFULLY!');\n                  console.log('🎯 Enhanced content was:', enhancedContent.substring(0, 300) + '...');\n\n                  // Don't send automatically - let user review and send manually\n                  if (event && typeof event.completed === 'function') {\n                    event.completed({ allowEvent: false });\n                  }\n                } else {\n                  console.error('❌ FAILED TO UPDATE EMAIL BODY');\n                  console.error('❌ Error details:', setResult.error);\n                  if (event && typeof event.completed === 'function') {\n                    event.completed({ allowEvent: false });\n                  }\n                }\n              }\n            );\n          } else {\n            // Show the actual API error message to the user\n            const errorMessage = enhancedContent || 'Unknown error occurred';\n            console.error('❌ Enhancement failed - content rejected:', errorMessage);\n            console.error('❌ Content was treated as error because it starts with error prefix');\n            \n            if (event && typeof event.completed === 'function') {\n              event.completed({ allowEvent: false });\n            }\n          }\n        })\n        .catch(error => {\n          console.error('❌ Error calling BotAtWork API:', error);\n          if (event && typeof event.completed === 'function') {\n            event.completed({ allowEvent: false });\n          }\n        });\n    } else {\n      console.error('❌ getSuggestedReply function not available - using simple fallback');\n      \n      // Simple dynamic fallback - just add basic structure to existing content\n      const fallbackEnhanced = `Dear [Recipient],\n\n${currentBody}\n\nMissing elements that should be added: ${keywordsList}\n\nBest regards,\n[Your Name]`;\n\n      console.log('🔄 ATTEMPTING FALLBACK EMAIL UPDATE...');\n      console.log('📝 Fallback content:', fallbackEnhanced.substring(0, 200) + '...');\n      \n      // Convert fallback content to HTML for proper formatting\n      const formattedFallbackHtml = convertMarkdownToOutlookHtml(fallbackEnhanced);\n      console.log('🔧 Converting fallback content to HTML...');\n      \n      item.body.setAsync(\n        formattedFallbackHtml,\n        { coercionType: Office.CoercionType.Html },\n        (setResult) => {\n          console.log('📝 Fallback setAsync callback called');\n          if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n            console.log('✅ EMAIL ENHANCED WITH FALLBACK CONTENT!');\n            if (event && typeof event.completed === 'function') {\n              event.completed({ allowEvent: false });\n            }\n          } else {\n            console.error('❌ FAILED TO UPDATE EMAIL BODY WITH FALLBACK');\n            console.error('❌ Fallback error details:', setResult.error);\n            if (event && typeof event.completed === 'function') {\n              event.completed({ allowEvent: false });\n            }\n          }\n        }\n      );\n      } // End of getSuggestedReply function check\n    }); // End of subject.getAsync callback\n  }); // End of body.getAsync callback\n}\n\n// Generate enhanced email content with missing keywords\nfunction generateEnhancedEmail(originalContent, selectedKeywords, isReply, callback, apiParams = {}) {\n  // Create prompt for AI to enhance the email\n  const keywordsList = selectedKeywords.join(', ');\n  const emailType = isReply ? 'reply' : 'new email';\n  \n  const enhancementPrompt = `Please enhance this ${emailType} by naturally incorporating these missing elements: ${keywordsList}\n\nOriginal content:\n${originalContent}\n\nInstructions:\n- Keep the original tone and intent\n- Naturally integrate the missing elements\n- Make it professional and coherent\n- Don't change the core message, just enhance it with the missing elements\n\nEnhanced ${emailType}:`;\n\n  // Extract dynamic parameters with defaults - use emailResponse for enhancing existing content\n  const {\n    chooseATask = \"emailResponse\",\n    description = enhancementPrompt,\n    emailContent = enhancementPrompt, // For emailResponse tasks\n    additionalInstructions = \"\",\n    tone = \"professional\",\n    pointOfView = \"organizationPerspective\",\n    anonymize = null,\n    incognito = false,\n    default_language = \"en-US\",\n    should_stream = false\n  } = apiParams;\n\n  // Call BotAtWork API to generate enhanced content\n  const requestBody = {\n    data: {\n      payload: {\n        chooseATask,\n        description,\n        additionalInstructions,\n        tone,\n        pointOfView\n      }\n    },\n    anonymize,\n    incognito,\n    default_language,\n    should_stream\n  };\n\n  // Use the centralized getSuggestedReply function from botAtWorkApi.js\n  if (typeof getSuggestedReply !== 'undefined') {\n    console.log('Using getSuggestedReply with apiParams:', apiParams);\n    getSuggestedReply(description, 3, apiParams)\n      .then(enhancedContent => {\n        callback(enhancedContent);\n      })\n      .catch(error => {\n        console.error('Failed to generate enhanced email:', error);\n        // Pass the actual API error message instead of null\n        const errorMessage = error.toString();\n        callback(errorMessage.startsWith('API error:') || errorMessage.startsWith('Error calling BotAtWork API:') ? errorMessage : `Failed to generate enhanced email: ${errorMessage}`);\n      });\n  } else {\n    console.error('getSuggestedReply function not available - falling back to direct API call');\n    \n    console.log('BotAtWork API Request Body:', JSON.stringify(requestBody, null, 2));\n\n    fetch(BOTATWORK_API_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'x-api-key': BOTATWORK_API_KEY\n      },\n      body: JSON.stringify(requestBody)\n    })\n    .then(response => response.json())\n    .then(data => {\n      console.log('BotAtWork API Response:', data);\n      if (data && data.status === \"SUCCESS\" && data.data && data.data.content) {\n        callback(data.data.content);\n      } else if (data && data.response) {\n        callback(data.response);\n      } else {\n        console.error('Invalid response from BotAtWork API:', data);\n        callback('API error: Invalid response format from BotAtWork API');\n      }\n    })\n    .catch(error => {\n      console.error('Failed to generate enhanced email:', error);\n      // Pass the actual API error message instead of null  \n      const errorMessage = error.toString();\n      callback(errorMessage.startsWith('API error:') || errorMessage.startsWith('Error calling BotAtWork API:') ? errorMessage : `Failed to generate enhanced email: ${errorMessage}`);\n    });\n  }\n}\n\n// Get dialog URL based on environment\nfunction getDialogUrl() {\n  const isLocalhost = window.location.hostname === 'localhost';\n  const dialogUrl = isLocalhost \n    ? 'https://localhost:3000/validation-dialog.html'\n    : 'https://nayaksubhasish.github.io/MS-Plugin/validation-dialog.html';\n  \n  console.log('🔗 Dialog URL:', dialogUrl);\n  console.log('🌐 Current hostname:', window.location.hostname);\n  console.log('🔧 Is localhost:', isLocalhost);\n  return dialogUrl;\n}\n\nOffice.onReady(() => {\n  // If needed, Office.js is ready to be called.\n  console.log('Office.js is ready - registering email validation');\n  \n  // Make functions globally available\n  window.validateEmail = validateEmail;\n  console.log('validateEmail function registered globally');\n  \n  // CRITICAL: Register ItemSend event handler for send interception - DISABLED\n  console.log('🔧 ItemSend event handler registration DISABLED');\n  \n  /*\n  // Add delay to ensure Office context is fully initialized\n  setTimeout(() => {\n    try {\n      if (Office.context && Office.context.mailbox && Office.context.mailbox.addHandlerAsync) {\n        console.log('📧 Office context is available, registering ItemSend handler...');\n        Office.context.mailbox.addHandlerAsync(\n          Office.EventType.ItemSend,\n          validateEmail,\n          (result) => {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n              console.log('✅✅✅ ItemSend event handler registered successfully! Send button will be intercepted! ✅✅✅');\n            } else {\n              console.error('❌ Failed to register ItemSend event handler:', result.error);\n            }\n          }\n        );\n      } else {\n        console.log('⚠️ Office context not fully available, trying again...');\n        // Try again after another delay\n        setTimeout(() => {\n          if (Office.context && Office.context.mailbox && Office.context.mailbox.addHandlerAsync) {\n            Office.context.mailbox.addHandlerAsync(Office.EventType.ItemSend, validateEmail);\n            console.log('✅ Second attempt: ItemSend handler registered');\n          }\n        }, 2000);\n      }\n    } catch (error) {\n      console.error('❌ Error registering ItemSend:', error);\n    }\n  }, 1000);\n  */\n});\n\n/**\n * Shows a notification when the add-in command is executed.\n * @param event {Office.AddinCommands.Event}\n */\nfunction action(event) {\n  const message = {\n    type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n    message: \"Performed action.\",\n    icon: \"Icon.80x80\",\n    persistent: true,\n  };\n\n  // Show a notification message.\n  Office.context.mailbox.item?.notificationMessages.replaceAsync(\n    \"ActionPerformanceNotification\",\n    message\n  );\n\n  // Be sure to indicate when the add-in command function is complete.\n  event.completed();\n}\n\n// Make functions globally available\nwindow.validateEmail = validateEmail;\nwindow.action = action;\n\n// Manual validation function that can be triggered by button\nfunction validateEmailManual(event) {\n  console.log('Manual email validation triggered');\n  \n  if (!Office.context || !Office.context.mailbox || !Office.context.mailbox.item) {\n    console.error('Office context not available');\n    event.completed();\n    return;\n  }\n  \n  const item = Office.context.mailbox.item;\n  \n  // Get email body content\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body:', result.error);\n      event.completed();\n      return;\n    }\n    \n    const bodyText = result.value.toLowerCase();\n    const missing = [];\n    \n    // Check for missing keywords\n    Object.keys(REQUIRED_KEYWORDS).forEach(key => {\n      const keywordData = REQUIRED_KEYWORDS[key];\n      const hasKeyword = keywordData.keywords.some(keyword => \n        bodyText.includes(keyword.toLowerCase())\n      );\n      \n      if (!hasKeyword) {\n        missing.push({\n          category: keywordData.category,\n          suggestions: keywordData.suggestions,\n          key: key\n        });\n      }\n    });\n    \n    if (missing.length > 0) {\n      // Show validation dialog\n      showValidationDialogManual(missing, event);\n    } else {\n      // All keywords present\n      const message = {\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n        message: \"✅ Email validation passed! All important elements are present.\",\n        icon: \"Icon.80x80\",\n        persistent: true,\n      };\n      \n      Office.context.mailbox.item?.notificationMessages.replaceAsync(\n        \"ValidationNotification\",\n        message\n      );\n      \n      event.completed();\n    }\n  });\n}\n\n// Show validation dialog for manual validation\nfunction showValidationDialogManual(missing, event) {\n  const dialogUrl = getDialogUrl();\n  \n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { \n      height: 40, \n      width: 35,\n      displayInIframe: true\n    },\n    (asyncResult) => {\n      if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n        console.error('Failed to open dialog:', asyncResult.error);\n        event.completed();\n        return;\n      }\n      \n      const dialog = asyncResult.value;\n      \n      // Send missing keywords data to dialog\n      setTimeout(() => {\n        dialog.messageChild(JSON.stringify({\n          type: 'missing-keywords',\n          data: missing\n        }));\n      }, 1000);\n      \n      // Handle dialog responses\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n        const response = JSON.parse(arg.message);\n        \n        if (response.action === 'send') {\n          // User chose to proceed\n          const message = {\n            type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n            message: \"Email validation completed. You can proceed with sending.\",\n            icon: \"Icon.80x80\",\n            persistent: true,\n          };\n          \n          Office.context.mailbox.item?.notificationMessages.replaceAsync(\n            \"ValidationNotification\",\n            message\n          );\n          \n          event.completed();\n        } else if (response.action === 'add-keywords') {\n          // User wants to add keywords\n          addKeywordsToEmailManual(response.keywords, event);\n        } else {\n          // User cancelled\n          event.completed();\n        }\n        \n        dialog.close();\n      });\n      \n      // Handle dialog errors\n      dialog.addEventHandler(Office.EventType.DialogEventReceived, (arg) => {\n        console.error('Dialog error:', arg.error);\n        event.completed();\n      });\n    }\n  );\n}\n\n// Add keywords for manual validation\nfunction addKeywordsToEmailManual(selectedKeywords, event) {\n  const item = Office.context.mailbox.item;\n  \n  // Get current email body\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body for keyword addition:', result.error);\n      event.completed();\n      return;\n    }\n    \n    const currentBody = result.value;\n    \n    // Determine if this is a new email or reply\n    const isReply = item.conversationId && item.conversationId.length > 0;\n    \n    // Prepare dynamic API parameters for manual email validation\n    const manualValidationApiParams = {\n      chooseATask: \"emailWrite\",\n      tone: \"professional\", // Can be made configurable based on user preference\n      pointOfView: \"organizationPerspective\", // Can be made configurable\n      additionalInstructions: \"Enhance the email by naturally incorporating the missing keywords while preserving the original tone and message\",\n      anonymize: null,\n      incognito: false,\n      default_language: \"en-US\",\n      should_stream: false\n    };\n\n    // Generate enhanced content with keywords\n    generateEnhancedEmail(currentBody, selectedKeywords, isReply, (enhancedContent) => {\n      if (enhancedContent && !enhancedContent.startsWith('API error:') && !enhancedContent.startsWith('Failed to generate enhanced email:') && !enhancedContent.startsWith('Error calling BotAtWork API:')) {\n        // Update email body with enhanced content - convert markdown to HTML for proper formatting\n        const formattedHtml = convertMarkdownToOutlookHtml(enhancedContent);\n        console.log('🔧 Converting markdown to HTML for manual validation...');\n        \n        item.body.setAsync(\n          formattedHtml,\n          { coercionType: Office.CoercionType.Html },\n          (setResult) => {\n            if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n              console.log('Email enhanced with keywords');\n              \n              const message = {\n                type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n                message: \"✅ Email enhanced with selected keywords!\",\n                icon: \"Icon.80x80\",\n                persistent: true,\n              };\n              \n              Office.context.mailbox.item?.notificationMessages.replaceAsync(\n                \"ValidationNotification\",\n                message\n              );\n              \n              event.completed();\n            } else {\n              console.error('Failed to update email body:', setResult.error);\n              event.completed();\n            }\n          }\n        );\n      } else {\n        // Show the actual API error message to the user\n        const errorMessage = enhancedContent || 'Unknown error occurred';\n        console.error('Enhancement failed:', errorMessage);\n        \n        const message = {\n          type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\n          message: errorMessage.startsWith('API error:') || errorMessage.startsWith('Error calling BotAtWork API:') ? errorMessage : `Failed to enhance email: ${errorMessage}`,\n          icon: \"Icon.80x80\",\n          persistent: true,\n        };\n        \n        Office.context.mailbox.item?.notificationMessages.replaceAsync(\n          \"ValidationNotification\",\n          message\n        );\n        \n        event.completed();\n      }\n    }, manualValidationApiParams);\n  });\n}\n\n// Send with validation function - validates and sends if all good, or shows dialog if missing keywords\nfunction sendWithValidation(event) {\n  console.log('Send with validation triggered');\n  \n  if (!Office.context || !Office.context.mailbox || !Office.context.mailbox.item) {\n    console.error('Office context not available');\n    event.completed();\n    return;\n  }\n  \n  const item = Office.context.mailbox.item;\n  \n  // Get email body content\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body:', result.error);\n      event.completed();\n      return;\n    }\n    \n    const bodyText = result.value.toLowerCase();\n    const missing = [];\n    \n    // Check for missing keywords\n    Object.keys(REQUIRED_KEYWORDS).forEach(key => {\n      const keywordData = REQUIRED_KEYWORDS[key];\n      const hasKeyword = keywordData.keywords.some(keyword => \n        bodyText.includes(keyword.toLowerCase())\n      );\n      \n      if (!hasKeyword) {\n        missing.push({\n          category: keywordData.category,\n          suggestions: keywordData.suggestions,\n          key: key\n        });\n      }\n    });\n    \n    if (missing.length > 0) {\n      // Show validation dialog with send option\n      showSendValidationDialog(missing, event);\n    } else {\n      // All keywords present, send directly\n      sendEmail(event);\n    }\n  });\n}\n\n// Show validation dialog for send with validation\nfunction showSendValidationDialog(missing, event) {\n  const dialogUrl = getDialogUrl();\n  \n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { \n      height: 40, \n      width: 35,\n      displayInIframe: true\n    },\n    (asyncResult) => {\n      if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n        console.error('Failed to open dialog:', asyncResult.error);\n        event.completed();\n        return;\n      }\n      \n      const dialog = asyncResult.value;\n      \n      // Send missing keywords data to dialog\n      setTimeout(() => {\n        dialog.messageChild(JSON.stringify({\n          type: 'missing-keywords',\n          data: missing,\n          mode: 'send' // Indicate this is for send validation\n        }));\n      }, 1000);\n      \n      // Handle dialog responses\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n        const response = JSON.parse(arg.message);\n        \n        if (response.action === 'send') {\n          // User chose to send anyway\n          sendEmail(event);\n        } else if (response.action === 'add-keywords') {\n          // User wants to add keywords then send\n          addKeywordsAndSend(response.keywords, event);\n        } else {\n          // User cancelled\n          event.completed();\n        }\n        \n        dialog.close();\n      });\n      \n      // Handle dialog errors\n      dialog.addEventHandler(Office.EventType.DialogEventReceived, (arg) => {\n        console.error('Dialog error:', arg.error);\n        event.completed();\n      });\n    }\n  );\n}\n\n// Add keywords and then send email\nfunction addKeywordsAndSend(selectedKeywords, event) {\n  const item = Office.context.mailbox.item;\n  \n  // Get current email body\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Failed) {\n      console.error('Failed to get email body for keyword addition:', result.error);\n      event.completed();\n      return;\n    }\n    \n    const currentBody = result.value;\n    \n    // Determine if this is a new email or reply\n    const isReply = item.conversationId && item.conversationId.length > 0;\n    \n    // Prepare dynamic API parameters for send with validation\n    const sendValidationApiParams = {\n      chooseATask: \"emailWrite\",\n      tone: \"professional\", // Can be made configurable\n      pointOfView: \"organizationPerspective\", // Can be made configurable\n      additionalInstructions: \"Quickly enhance the email with missing keywords and prepare it for sending while maintaining professional tone\",\n      anonymize: null,\n      incognito: false,\n      default_language: \"en-US\",\n      should_stream: false\n    };\n\n    // Generate enhanced content with keywords\n    generateEnhancedEmail(currentBody, selectedKeywords, isReply, (enhancedContent) => {\n      if (enhancedContent && !enhancedContent.startsWith('API error:') && !enhancedContent.startsWith('Failed to generate enhanced email:') && !enhancedContent.startsWith('Error calling BotAtWork API:')) {\n        // Update email body with enhanced content - convert markdown to HTML for proper formatting\n        const formattedHtml = convertMarkdownToOutlookHtml(enhancedContent);\n        console.log('🔧 Converting markdown to HTML for send validation...');\n        \n        item.body.setAsync(\n          formattedHtml,\n          { coercionType: Office.CoercionType.Html },\n          (setResult) => {\n            if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n              console.log('Email enhanced with keywords, now sending...');\n              // Send the enhanced email\n              sendEmail(event);\n            } else {\n              console.error('Failed to update email body:', setResult.error);\n              event.completed();\n            }\n          }\n        );\n      } else {\n        // Show the actual API error message to the user\n        const errorMessage = enhancedContent || 'Unknown error occurred';\n        console.error('Enhancement failed:', errorMessage);\n        \n        // Failed to enhance, ask user if they want to send anyway\n        const message = {\n          type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\n          message: errorMessage.startsWith('API error:') || errorMessage.startsWith('Error calling BotAtWork API:') ? `${errorMessage} Send anyway?` : `Failed to enhance email: ${errorMessage}. Send anyway?`,\n          icon: \"Icon.80x80\",\n          persistent: true,\n        };\n        \n        Office.context.mailbox.item?.notificationMessages.replaceAsync(\n          \"ValidationNotification\",\n          message\n        );\n        \n        event.completed();\n      }\n    }, sendValidationApiParams);\n  });\n}\n\n// Send the email\nfunction sendEmail(event) {\n  if (Office.context && Office.context.mailbox && Office.context.mailbox.item) {\n    // Show success message\n    const message = {\n      type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n      message: \"✅ Email validation completed. Sending email...\",\n      icon: \"Icon.80x80\",\n      persistent: false,\n    };\n    \n    Office.context.mailbox.item?.notificationMessages.replaceAsync(\n      \"ValidationNotification\",\n      message\n    );\n    \n    // Send the email using Outlook's send method\n    Office.context.mailbox.item.saveAsync((saveResult) => {\n      if (saveResult.status === Office.AsyncResultStatus.Succeeded) {\n        // For compose mode, we can't directly send, but we can save and notify user\n        const sendMessage = {\n          type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n          message: \"✅ Email ready to send! Please click the Send button in Outlook.\",\n          icon: \"Icon.80x80\",\n          persistent: true,\n        };\n        \n        Office.context.mailbox.item?.notificationMessages.replaceAsync(\n          \"SendNotification\",\n          sendMessage\n        );\n      }\n    });\n  }\n  \n  event.completed();\n}\n\n// Register the functions with Office\nconsole.log('🔧 Registering Office.actions functions...');\nOffice.actions.associate(\"action\", action);\nconsole.log('✅ action function registered');\nOffice.actions.associate(\"validateEmail\", validateEmail);\nconsole.log('✅ validateEmail function registered');\nOffice.actions.associate(\"validateEmailManual\", validateEmailManual);\nconsole.log('✅ validateEmailManual function registered');\nOffice.actions.associate(\"sendWithValidation\", sendWithValidation);\nconsole.log('✅ sendWithValidation function registered');\n\n// CRITICAL: Add alternative event registration for ItemSend - DISABLED\nconsole.log('🔧 Alternative ItemSend registration DISABLED');\n/*\ntry {\n  // Try to register the event handler directly\n  if (Office.context && Office.context.mailbox) {\n    console.log('✅ Office context available for alternative registration');\n    \n    // Register ItemSend event handler\n    Office.context.mailbox.addHandlerAsync(\n      Office.EventType.ItemSend,\n      validateEmail,\n      (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          console.log('✅ ItemSend event handler registered successfully');\n        } else {\n          console.error('❌ Failed to register ItemSend event handler:', result.error);\n        }\n      }\n    );\n  }\n} catch (error) {\n  console.error('❌ Error in alternative registration:', error);\n}\n*/\n\n// Test function to manually trigger validation\nfunction testValidation() {\n  console.log('🧪 Testing validation manually');\n  const testEvent = {\n    completed: (result) => {\n      console.log('✅ Test validation completed:', result);\n    }\n  };\n  validateEmail(testEvent);\n}\n\n// Function to reset validation state\nfunction resetValidationState() {\n  console.log('🔄 Resetting validation state');\n  validationState = {\n    lastValidationTime: 0,\n    lastEmailBody: '',\n    validationInProgress: false\n  };\n  console.log('✅ Validation state reset:', validationState);\n}\n\n// Function to check validation state\nfunction checkValidationState() {\n  console.log('📊 Current validation state:', validationState);\n  return validationState;\n}\n\n// Function to check if validation is properly registered\nfunction checkValidationRegistration() {\n  console.log('🔍 Checking validation registration...');\n  console.log('✅ validateEmail function exists:', typeof validateEmail === 'function');\n  console.log('✅ Office context available:', !!Office.context);\n  console.log('✅ Mailbox available:', !!Office.context?.mailbox);\n  console.log('✅ Current validation state:', validationState);\n  console.log('🎯 Last validation event:', window.lastValidationEvent);\n  \n  // Test if we can access the email item\n  if (Office.context?.mailbox?.item) {\n    console.log('✅ Email item accessible');\n    Office.context.mailbox.item.body.getAsync(\"text\", (result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        console.log('✅ Email body accessible, length:', result.value.length);\n      } else {\n        console.log('❌ Email body not accessible:', result.error);\n      }\n    });\n  } else {\n    console.log('❌ Email item not accessible');\n  }\n}\n\n// Function to test event completion manually\nfunction testEventCompletion(allowEvent = false) {\n  console.log('🧪 Testing event completion with allowEvent:', allowEvent);\n  \n  if (window.lastValidationEvent) {\n    console.log('🎯 Using last validation event');\n    try {\n      window.lastValidationEvent.completed({ allowEvent });\n      console.log('✅ Manual event.completed called successfully');\n    } catch (error) {\n      console.error('❌ Error in manual event.completed:', error);\n    }\n  } else {\n    console.log('❌ No validation event available for testing');\n  }\n}\n\n// Make functions globally available\nwindow.testValidation = testValidation;\nwindow.resetValidationState = resetValidationState;\nwindow.checkValidationState = checkValidationState;\nwindow.checkValidationRegistration = checkValidationRegistration;\nwindow.testEventCompletion = testEventCompletion;\n"],"names":["inProgress","dataWebpackPrefix","module","exports","isFunction","x","isArray","Array","Object","prototype","toString","call","len","vertxNext","customSchedulerFn","asap","callback","arg","queue","flush","scheduleFlush","browserWindow","window","undefined","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","self","process","isWorker","Uint8ClampedArray","importScripts","MessageChannel","useSetTimeout","globalSetTimeout","setTimeout","i","channel","iterations","observer","node","then","onFulfillment","onRejection","parent","this","child","constructor","noop","PROMISE_ID","makePromise","_state","arguments","invokeCallback","_result","subscribe","resolve$1","object","promise","resolve","nextTick","document","createTextNode","observe","characterData","data","port1","onmessage","port2","postMessage","vertx","Function","require","runOnLoop","runOnContext","e","attemptVertx","Math","random","substring","PENDING","FULFILLED","REJECTED","handleMaybeThenable","maybeThenable","then$$1","thenable","fulfill","reject","value","reason","handleOwnThenable","sealed","error","fulfillmentHandler","rejectionHandler","tryThen","_label","handleForeignThenable","TypeError","type","publishRejection","_onerror","publish","_subscribers","length","subscribers","settled","detail","hasCallback","succeeded","id","Enumerator","Constructor","input","_instanceConstructor","_remaining","_enumerate","Error","_eachEntry","entry","c","resolve$$1","_then","didError","_settledAt","Promise$1","_willSettleAt","state","enumerator","Promise","resolver","needsResolver","initializePromise","needsNew","catch","finally","all","entries","race","_","_setScheduler","scheduleFn","_setAsap","asapFn","_asap","polyfill","local","g","P","promiseToString","cast","factory","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","d","definition","key","o","defineProperty","enumerable","get","f","chunkId","keys","reduce","promises","u","globalThis","obj","prop","hasOwnProperty","l","url","done","push","script","needAttach","scripts","getElementsByTagName","s","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","fn","bind","target","head","appendChild","r","Symbol","toStringTag","scriptUrl","location","currentScript","tagName","toUpperCase","test","replace","p","installedChunks","j","installedChunkData","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","some","chunkLoadingGlobal","_regeneratorRuntime","t","n","iterator","a","asyncIterator","configurable","writable","h","Generator","create","method","delegate","sent","_sent","dispatchException","abrupt","Context","wrap","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","y","v","_invoke","AsyncIterator","_typeof","__await","return","next","w","tryEntries","reset","isNaN","displayName","isGeneratorFunction","mark","setPrototypeOf","__proto__","awrap","async","unshift","pop","values","charAt","slice","stop","rval","complete","finish","delegateYield","asyncGeneratorStep","console","log","Date","toISOString","getSuggestedReply","BOTATWORK_API_KEY","BOTATWORK_API_URL","_ref","_callee","params","response","_context","fetch","headers","concat","body","JSON","stringify","ok","status","json","result","content","t0","apply","_next","_throw","_x","REQUIRED_KEYWORDS","agenda","keywords","category","suggestions","action","timeline","participants","greeting","closing","validationState","lastValidationTime","lastEmailBody","validationInProgress","convertMarkdownToOutlookHtml","markdownText","html","match","lines","trim","split","header","separator","dataRows","headerCells","map","cell","filter","Boolean","tableRows","row","tableHtml","escapeHtml","text","String","validateEmail","completed","lastValidationEvent","Office","context","mailbox","item","allowEvent","getAsync","AsyncResultStatus","Failed","bodyText","toLowerCase","now","missing","keywordData","keyword","includes","dialogUrl","getDialogUrl","ui","displayDialogAsync","height","width","displayInIframe","asyncResult","dialog","attempts","sendDataToDialog","messageChild","addEventHandler","EventType","DialogMessageReceived","parse","selectedKeywords","currentBody","isReply","conversationId","keywordsList","join","subject","subjectResult","emailSubject","Succeeded","enhancementPrompt","validationApiParams","chooseATask","emailContent","tone","pointOfView","additionalInstructions","anonymize","incognito","default_language","should_stream","enhancedContent","startsWith","errorMessage","setAsync","formattedHtml","coercionType","CoercionType","Html","setResult","fallbackEnhanced","formattedFallbackHtml","addKeywordsToEmail","close","DialogEventReceived","showValidationDialog","generateEnhancedEmail","originalContent","apiParams","emailType","_apiParams$chooseATas","_apiParams$descriptio","description","_apiParams$additional","_apiParams$tone","_apiParams$pointOfVie","_apiParams$anonymize","_apiParams$incognito","_apiParams$default_la","_apiParams$should_str","requestBody","payload","isLocalhost","hostname","_Office$context$mailb","MailboxEnums","ItemNotificationMessageType","InformationalMessage","icon","persistent","notificationMessages","replaceAsync","sendEmail","_Office$context$mailb7","saveAsync","saveResult","_Office$context$mailb8","sendMessage","onReady","actions","associate","_Office$context$mailb3","_Office$context$mailb5","ErrorMessage","_Office$context$mailb4","addKeywordsToEmailManual","showValidationDialogManual","_Office$context$mailb2","mode","_Office$context$mailb6","addKeywordsAndSend","showSendValidationDialog","testValidation","resetValidationState","checkValidationState","checkValidationRegistration","_Office$context","_Office$context2","testEventCompletion"],"sourceRoot":""}