{"version":3,"file":"186.js","mappings":"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","sources":["webpack://outlook-plugin/./src/taskpane/botAtWorkApi.js"],"sourcesContent":["// BotAtWork API utility for email generation and suggestions\nconst BOTATWORK_API_KEY = \"e80f5458c550f5b85ef56175b789468a\";\nconst BOTATWORK_API_URL = \"https://api.botatwork.com/trigger-task/b6f44edd-8140-4084-881e-2c11c403c082\";\nconst DEBUG_LOGS_ENABLED = false; // Toggle verbose logs\n\n// Helper function to get logged-in user's email\nconst getLoggedInUserEmail = () => {\n  try {\n    if (window.Office && Office.context && Office.context.mailbox && Office.context.mailbox.userProfile && Office.context.mailbox.userProfile.emailAddress) {\n      return Office.context.mailbox.userProfile.emailAddress;\n    }\n  } catch (error) {\n    if (DEBUG_LOGS_ENABLED) {\n      console.warn('Failed to get user email:', error);\n    }\n  }\n  return \"unknown@unknown.com\";\n};\n\n// Normalize and clamp prompt length to reduce payload and latency\nconst clampText = (text, maxLen = 4000) => {\n  if (!text) return \"\";\n  return text.length > maxLen ? text.slice(0, maxLen) + \"...\" : text;\n};\n\n// Simple in-memory cache to avoid duplicate roundtrips during a session\nconst responseCache = new Map();\n\n// Track last in-flight request to cancel when a new one starts\nlet lastController = null;\n\n// Helper function to add delay\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n// Helper function to check if error is retryable\nconst isRetryableError = (error) => {\n  if (!error) return false;\n  \n  const errorMessage = (error.message || error.toString() || '').toLowerCase();\n  \n  // Always retry HTTP 5xx errors (server errors) as they are usually transient\n  if (errorMessage.includes('500') || errorMessage.includes('502') || errorMessage.includes('503') || \n      errorMessage.includes('504') || errorMessage.includes('http 5')) {\n    return true;\n  }\n  \n  const retryableMessages = [\n    'overloaded',\n    'rate limit',\n    'quota exceeded',\n    'service unavailable',\n    'internal error',\n    'timeout',\n    'network error',\n    'connection',\n    'server error',\n    '5'  // HTTP 5xx errors\n  ];\n  \n  return retryableMessages.some(msg => errorMessage.includes(msg));\n};\n\n// Helper function to determine task type and format payload\nconst formatPayload = (prompt, taskType = 'emailWrite', apiParams = {}) => {\n  // Extract dynamic parameters with defaults\n  const {\n    additionalInstructions = \"\",\n    tone = \"formal\",\n    pointOfView = \"organizationPerspective\",\n    description: apiDescription = null,\n    emailContent: apiEmailContent = null\n  } = apiParams;\n\n  // Get logged-in user's email for hiddenValue\n  const userEmail = getLoggedInUserEmail();\n  const hiddenValue = `{From person: ${userEmail}}`;\n\n  if (DEBUG_LOGS_ENABLED) {\n    console.log('BotAtWork API - formatPayload received apiParams:', apiParams);\n    console.log('BotAtWork API - Extracted parameters:', { tone, pointOfView, additionalInstructions });\n    console.log('BotAtWork API - User email for hiddenValue:', userEmail);\n  }\n\n  // Clean and structure the prompt for better API understanding\n  const cleanPrompt = clampText(prompt.replace(/^(Write a professional email with the following details:|Suggest a professional reply to this email considering the specified tone and point of view:|Please provide a helpful response to this follow-up question or request:)/i, '').trim());\n\n  // For email writing tasks (new emails)\n  if (taskType === 'emailWrite') {\n    // Extract description from the prompt, but use dynamic tone and pointOfView\n    // Updated regex to capture multi-line descriptions by using [\\s\\S]*? (non-greedy match of any character including newlines)\n    const descriptionMatch = prompt.match(/Description:\\s*([\\s\\S]*?)(?=\\nTone:|$)/i);\n    \n    // Always use the dynamic parameters for tone and pointOfView, not extracted from prompt\n    return {\n      chooseATask: \"emailWrite\",\n      description: clampText(descriptionMatch ? descriptionMatch[1].trim() : (apiDescription != null ? apiDescription : cleanPrompt)),\n      //additionalInstructions: additionalInstructions || \"Write a professional email that matches the specified tone and perspective exactly. Use 'we', 'our', 'us' for organization perspective and 'I', 'my', 'me' for individual perspective.\",\n     // tone: tone, // Always use the dynamic tone parameter\n     // pointOfView: pointOfView === \"individualPerspective\" ? \"individualPerspective\" : \"organizationPerspective\", // Map to API expected values\n      hiddenValue: hiddenValue,\n      \"run_on_behalf\": userEmail,\n      \"emailPreferencePrompt\": true\n    };\n  }\n\n  // For email response tasks (replies, suggestions, enhancements)\n  if (taskType === 'emailResponse') {\n    return {\n      chooseATask: \"emailResponse\",\n      emailContent: clampText(apiEmailContent != null ? apiEmailContent : cleanPrompt),\n      additionalInstructions: additionalInstructions || \"\",\n     // tone,\n     // pointOfView: pointOfView === \"individualPerspective\" ? \"individualPerspective\" : \"organizationPerspective\",\n      hiddenValue: hiddenValue,\n      \"run_on_behalf\": userEmail,\n      \"emailPreferencePrompt\": true\n    };\n  }\n\n  // For email rewrite tasks (editing existing emails)\n  if (taskType === 'emailRewrite') {\n    return {\n      chooseATask: \"emailRewrite\",\n      emailContent: clampText(apiEmailContent != null ? apiEmailContent : cleanPrompt),\n      additionalInstructions: additionalInstructions || \"\",\n     // tone,\n     // pointOfView: pointOfView === \"individualPerspective\" ? \"individualPerspective\" : \"organizationPerspective\",\n      hiddenValue: hiddenValue,\n      \"run_on_behalf\": userEmail,\n      \"emailPreferencePrompt\": true\n    };\n  }\n\n  // For chat/conversation tasks\n  if (taskType === 'chat') {\n    return {\n      chooseATask: \"emailWrite\", // Use emailWrite for chat as it's more flexible\n      description: clampText(cleanPrompt),\n     // additionalInstructions: additionalInstructions || \"Provide a helpful and conversational response. Use 'we', 'our', 'us' for organization perspective and 'I', 'my', 'me' for individual perspective.\",\n     // tone,\n     // pointOfView: pointOfView === \"individualPerspective\" ? \"individualPerspective\" : \"organizationPerspective\",\n      hiddenValue: hiddenValue,\n      \"run_on_behalf\": userEmail,\n      \"emailPreferencePrompt\": true\n    };\n  }\n\n  // Default fallback\n  return {\n    chooseATask: \"emailWrite\",\n    description: clampText(apiDescription != null ? apiDescription : cleanPrompt),\n   // additionalInstructions: additionalInstructions || \"Write a professional email that matches the specified tone and perspective. Use 'we', 'our', 'us' for organization perspective and 'I', 'my', 'me' for individual perspective.\",\n   // tone,\n    //pointOfView: pointOfView === \"individualPerspective\" ? \"individualPerspective\" : \"organizationPerspective\",\n    hiddenValue: hiddenValue,\n    \"run_on_behalf\": userEmail,\n    \"emailPreferencePrompt\": true\n  };\n};\n\nexport async function getSuggestedReply(prompt, maxRetries = 10, apiParams = {}) {\n  // Extract dynamic parameters with defaults\n  const {\n    chooseATask = \"emailWrite\",\n    description = prompt,\n    emailContent = prompt, // For emailResponse tasks\n    additionalInstructions = \"\",\n    tone = \"formal\",\n    pointOfView = \"organizationPerspective\",\n    anonymize = null,\n    incognito = false,\n    default_language = \"en-US\",\n    should_stream = false\n  } = apiParams;\n\n  // Get logged-in user's email for run_on_behalf\n  const userEmail = getLoggedInUserEmail();\n\n  // Create payload based on task type using formatPayload\n  const payload = formatPayload(clampText(prompt), chooseATask, apiParams);\n  \n  const requestBody = {\n    data: {\n      payload: payload\n    },\n    anonymize,\n    incognito,\n    default_language,\n    should_stream,\n    \"run_on_behalf\": userEmail,\n    \"emailPreferencePrompt\": true\n  };\n\n  // Return cached response if available\n  const cacheKey = JSON.stringify({ payload, anonymize, incognito, default_language });\n  if (responseCache.has(cacheKey)) {\n    if (DEBUG_LOGS_ENABLED) console.log('BotAtWork API - returning cached response');\n    return responseCache.get(cacheKey);\n  }\n\n  if (DEBUG_LOGS_ENABLED) {\n    console.log('BotAtWork API - Using dynamic parameters:', {\n      chooseATask,\n      tone,\n      pointOfView,\n      additionalInstructions,\n      default_language\n    });\n    console.log('BotAtWork API - Final payload being sent:', JSON.stringify(payload, null, 2));\n  }\n\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\n    try {\n      if (DEBUG_LOGS_ENABLED) {\n        console.log(`BotAtWork API attempt ${attempt}/${maxRetries}`);\n        console.log(\"Request payload:\", JSON.stringify(requestBody, null, 2));\n      }\n\n      // Cancel any previous in-flight request (only when a NEW request starts)\n      if (lastController) {\n        try { lastController.abort('new-request'); } catch (_) {}\n      }\n      const controller = new AbortController();\n      lastController = controller;\n      // IMPORTANT: NO TIMEOUT - Let the plugin wait as long as needed for the bot to generate\n      // This is especially important for long emails (5000+ words) that can take 30+ seconds\n      // We want to wait until the server responds, no matter how long it takes\n\n      const response = await fetch(BOTATWORK_API_URL, {\n        method: \"POST\",\n        headers: { \n          \"Content-Type\": \"application/json\",\n          \"x-api-key\": BOTATWORK_API_KEY\n        },\n        body: JSON.stringify(requestBody),\n        signal: controller.signal\n      });\n      // No timeout to clear since we allow long-running requests\n      \n      if (!response.ok) {\n        // For HTTP 5xx errors, treat them as retryable server errors\n        if (response.status >= 500 && response.status < 600) {\n          const error = new Error(`HTTP ${response.status}: ${response.statusText}`);\n          error.isServerError = true; // Mark as server error for retry logic\n          throw error;\n        }\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      if (DEBUG_LOGS_ENABLED) {\n        console.log(\"BotAtWork API raw response:\", data);\n      }\n      \n      // Check for successful response - BotAtWork API format\n      if (data && data.status === \"SUCCESS\" && data.data && data.data.content) {\n        responseCache.set(cacheKey, data.data.content);\n        return data.data.content;\n      }\n      \n      // Fallback: Check for other possible response formats\n      if (data && (data.result || data.response || data.output || data.content)) {\n        const result = data.result || data.response || data.output || data.content;\n        const normalized = typeof result === 'string' ? result : JSON.stringify(result);\n        responseCache.set(cacheKey, normalized);\n        return normalized;\n      }\n      \n      // If data has a message field, use that\n      if (data && data.message) {\n        responseCache.set(cacheKey, data.message);\n        return data.message;\n      }\n      \n      // If data is a string, return it directly\n      if (typeof data === 'string') {\n        responseCache.set(cacheKey, data);\n        return data;\n      }\n      \n      // Check for API errors - BotAtWork API format\n      if (data && data.status !== \"SUCCESS\") {\n        const errorMessage = data.message || data.status || \"Unknown error\";\n        if (DEBUG_LOGS_ENABLED) {\n          console.log(`BotAtWork API error on attempt ${attempt}:`, errorMessage);\n        }\n        \n        // Check if this is a retryable error\n        if (isRetryableError({ message: errorMessage }) && attempt < maxRetries) {\n          const backoffDelay = Math.pow(2, attempt - 1) * 1000 + Math.random() * 1000; // Exponential backoff with jitter\n          if (DEBUG_LOGS_ENABLED) {\n            console.log(`Retrying in ${Math.round(backoffDelay)}ms...`);\n          }\n          await delay(backoffDelay);\n          continue;\n        }\n        \n        // If not retryable or max retries reached, return error\n        return `API error: ${errorMessage}${attempt > 1 ? ` (after ${attempt} attempts)` : ''}`;\n      }\n      \n      // Check for generic API errors\n      if (data && data.error) {\n        const errorMessage = data.error.message || data.error.toString() || JSON.stringify(data.error);\n        if (DEBUG_LOGS_ENABLED) {\n          console.log(`BotAtWork API error on attempt ${attempt}:`, errorMessage);\n        }\n        \n        // Check if this is a retryable error\n        if (isRetryableError(data.error) && attempt < maxRetries) {\n          const backoffDelay = Math.pow(2, attempt - 1) * 1000 + Math.random() * 1000; // Exponential backoff with jitter\n          if (DEBUG_LOGS_ENABLED) {\n            console.log(`Retrying in ${Math.round(backoffDelay)}ms...`);\n          }\n          await delay(backoffDelay);\n          continue;\n        }\n        \n        // If not retryable or max retries reached, return error\n        return `API error: ${errorMessage}${attempt > 1 ? ` (after ${attempt} attempts)` : ''}`;\n      }\n      \n      // If we get here, we have data but couldn't parse it\n      if (DEBUG_LOGS_ENABLED) {\n        console.log(\"Unexpected response format:\", data);\n      }\n      return \"Response received but format unexpected. Raw response: \" + JSON.stringify(data);\n      \n    } catch (e) {\n      if (DEBUG_LOGS_ENABLED) {\n        console.log(`Network error on attempt ${attempt}:`, e.message);\n      }\n      \n      // Always retry server errors (HTTP 5xx) as they are usually transient\n      if (e.isServerError || e.message.includes('500') || e.message.includes('502') || \n          e.message.includes('503') || e.message.includes('504')) {\n        if (attempt < maxRetries) {\n          const backoffDelay = Math.pow(2, attempt - 1) * 1000 + Math.random() * 1000;\n          if (DEBUG_LOGS_ENABLED) {\n            console.log(`Server error detected, retrying in ${Math.round(backoffDelay)}ms... (attempt ${attempt}/${maxRetries})`);\n          }\n          await delay(backoffDelay);\n          continue;\n        }\n      }\n      \n      // Check if this is a retryable error (includes network issues, timeouts, or other transient errors)\n      if (attempt < maxRetries && isRetryableError(e)) {\n        const backoffDelay = Math.pow(2, attempt - 1) * 1000 + Math.random() * 1000;\n        if (DEBUG_LOGS_ENABLED) {\n          console.log(`Retrying in ${Math.round(backoffDelay)}ms...`);\n        }\n        await delay(backoffDelay);\n        continue;\n      }\n      \n      // Max retries reached or non-retryable error\n      return `Error calling BotAtWork API: ${e.message} (after ${attempt} attempts)`;\n    }\n  }\n  \n  // This should never be reached, but just in case\n  return \"Maximum retry attempts reached. Please try again later.\";\n}\n"],"names":["_regeneratorRuntime","r","t","e","Object","prototype","n","hasOwnProperty","o","Symbol","i","iterator","a","asyncIterator","u","toStringTag","c","defineProperty","value","enumerable","configurable","writable","h","Generator","create","Error","done","method","arg","delegate","d","f","sent","_sent","dispatchException","abrupt","s","type","Context","call","wrap","GeneratorFunction","GeneratorFunctionPrototype","l","p","getPrototypeOf","y","x","v","g","forEach","_invoke","AsyncIterator","_typeof","resolve","__await","then","return","TypeError","next","w","tryEntries","push","m","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","unshift","pop","values","prev","charAt","slice","stop","rval","complete","finish","catch","delegateYield","asyncGeneratorStep","getLoggedInUserEmail","window","Office","context","mailbox","userProfile","emailAddress","error","clampText","text","maxLen","arguments","undefined","responseCache","Map","lastController","delay","ms","setTimeout","isRetryableError","errorMessage","message","toString","toLowerCase","includes","some","msg","formatPayload","prompt","taskType","apiParams","_apiParams$additional","additionalInstructions","_apiParams$descriptio","tone","pointOfView","description","apiDescription","_apiParams$emailConte","emailContent","apiEmailContent","userEmail","hiddenValue","concat","cleanPrompt","replace","trim","descriptionMatch","match","chooseATask","getSuggestedReply","_x","_getSuggestedReply","apply","_callee","maxRetries","_apiParams$chooseATas","_apiParams$anonymize","anonymize","_apiParams$incognito","incognito","_apiParams$default_la","default_language","_apiParams$should_str","should_stream","payload","requestBody","cacheKey","attempt","controller","response","data","result","normalized","backoffDelay","_errorMessage","_backoffDelay","_backoffDelay2","_backoffDelay3","_args","_context","JSON","stringify","has","get","abort","_","AbortController","fetch","headers","body","signal","ok","status","statusText","isServerError","json","content","set","output","Math","pow","random","t0","_next","_throw"],"sourceRoot":""}